---
layout: blog
time-series-process: true
mathjax: true
date:   2021-11-26
background-image: https://7568.github.io/images/2021-11-26-tabnet/img.png
title:  TabNet - Attentive Interpretable Tabular Learning
category: time series å¤„ç†
tags:
- tabular data
- time series
---

[tabnet-architecture]:https://7568.github.io/images/2021-11-26-tabnet/tabnet-architecture.png
[sparsemax-compare-softmax]:https://7568.github.io/images/2021-11-26-tabnet/sparsemax-compare-softmax.png

# ç®€ä»‹

TabNet æ˜¯2020å¹´ Google Cloud AI å›¢é˜Ÿå‘è¡¨çš„ä¸€ç¯‡ç”¨æ¥å¤„ç†è¡¨æ ¼æ•°æ®çš„æ·±åº¦ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå®ƒå¯è§£é‡Šæ€§å¼ºè€Œä¸”ä½¿ç”¨åˆ°äº†è‡ªç›‘ç£æŠ€æœ¯ï¼Œæœ¬æ–‡å°†
é€šè¿‡[ğŸ’ ğŸ’ ğŸ’ è®ºæ–‡ ğŸ’ ğŸ’ ğŸ’](https://arxiv.org/pdf/1908.07442.pdf) å’Œ[ğŸ’ ğŸ’ ğŸ’ ä»£ç  ğŸ’ ğŸ’ ğŸ’](https://github.com/dreamquark-ai/tabnet) æ¥å¯¹ TabNet è¿›è¡Œä»‹ç»ã€‚

# è®ºæ–‡ä»‹ç»

TabNet ä¼˜ç‚¹å¦‚ä¸‹ï¼š
1. æ–¹ä¾¿ä½¿ç”¨ï¼Œå¯¹åŸå§‹æ•°æ®ä¸éœ€è¦åšä»»ä½•å…¶ä»–çš„æ“ä½œï¼Œå°±èƒ½ç›´æ¥ä½¿ç”¨ï¼Œè€Œä¸” TabNet æ˜¯ç«¯å¯¹ç«¯çš„ï¼Œè®­ç»ƒèµ·æ¥éå¸¸æ–¹ä¾¿ã€‚
2. TabNet ä½¿ç”¨ attention æœºåˆ¶ï¼Œä½¿å¾—æ¨¡å‹çš„è§£é‡Šæ€§å¼ºã€‚
3. TabNet æ•ˆæœå¥½ï¼Œå¹¶ä¸”æœ‰ä¸¤ç§ä¸åŒçš„å¯è§£é‡Šæ€§ï¼Œä¸€ä¸ªæ˜¯å±€éƒ¨å¯è§£é‡Šæ€§ï¼Œä¸€ä¸ªæ˜¯å…¨å±€å¯è§£é‡Šæ€§ã€‚
4. æˆ‘ä»¬çš„éç›‘ç£é¢„è®­ç»ƒæ¨¡å‹å¯¹ç¬¬ä¸€æ¬¡è§åˆ°çš„è¡¨æ ¼æ•°æ®è¿›è¡Œå¡«è¯æ¸¸æˆæœ‰ç›¸å½“å¥½çš„æ•ˆæœã€‚

ä¸‹å›¾å±•ç¤ºäº† TabNet çš„æ•´ä½“ç»“æ„

![tabnet-architecture]

æ•´ä½“åˆ†ä¸º encoder å’Œ decoder ä¸¤éƒ¨åˆ†ï¼Œåœ¨ encoder ä¸­æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„ç»“æ„ï¼Œåˆ†åˆ«ä¸º feature transformerï¼Œattentive transformerå’Œ feature maskingï¼Œå…¶ä¸­ feature transformer æ˜¯
ç”¨æ¥è¿›è¡Œç‰¹å¾æå–ï¼Œ attentive transformer æ˜¯ç”¨æ¥è¿›è¡Œç‰¹å¾é€‰æ‹©ï¼Œå’Œæä¾›å¯¹æ¨¡å‹çš„å¯è§£é‡Šæ€§ï¼Œè€Œ feature masking æ˜¯ç”¨æ¥è·å–å…¨å±€ç‰¹å¾é‡è¦æ€§çš„åˆ†å¸ƒã€‚
å›¾ä¸­çš„ï¼ˆaï¼‰æ˜¯encoderç»“æ„ï¼Œï¼ˆbï¼‰æ˜¯ decoder ç»“æ„ï¼Œï¼ˆcï¼‰æ˜¯ feature transformerï¼Œé‡Œé¢å¯ä»¥åˆ†æˆ4å±‚ï¼Œæ¯ä¸€å±‚éƒ½æ˜¯ç”± FCï¼ŒBNï¼Œ[GLU](https://7568.github.io/2021/11/15/cnn-seq2seqModel.html#glu) æ„æˆã€‚å…¶ä¸­å‰2å±‚ä¸º Shared across decision stepsï¼Œå¦å¤–ä¸¤å±‚ä¸º Decision step dependentï¼Œ
ï¼ˆdï¼‰æ˜¯ attentive transformer ç»“æ„ï¼Œé‡Œé¢çš„ [sparsemax](https://arxiv.org/pdf/1602.02068) ç”¨æ¥åšå½’ä¸€åŒ–å¤„ç†ï¼Œå¹¶ä¸”ç»“æœä¸­åªåŒ…å«çªå‡ºçš„ç‰¹å¾ä¿¡æ¯ã€‚

## sparsemax

sparsemax å¸¸ç”¨äºå¤šæ ‡ç­¾åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œé€šå¸¸å½“ä½œç¥ç»ç½‘ç»œçš„æ¿€æ´»å‡½æ•°æ”¾åœ¨æœ€åä¸€å±‚å–ä»£softmaxã€‚sparsemaxå’Œsoftmaxçš„åŒºåˆ«å¦‚ä¸‹ï¼š

![sparsemax-compare-softmax]

ä¸ªäººç†è§£ sparsemax çš„ä¼˜åŠ¿æ˜¯åœ¨å¤šåˆ†ç±»ä»»åŠ¡ä¸­ï¼Œä½¿ç”¨ sparsemax èƒ½å¤Ÿå¹³è¡¡ä¸€ä¸ªæ ·æœ¬å±äºå¤šä¸ªåˆ†ç±»çš„æƒé‡ï¼Œè€Œåœ¨ softmaxä¸­
ä¸€ä¸ªæ ·æœ¬è™½ç„¶å¯èƒ½å±äºå¤šä¸ªç±»åˆ«ï¼Œä½†æ˜¯ä»–ä»¬çš„æƒé‡å´æ˜¯ä¸ä¸€æ ·çš„ã€‚ä¾‹å¦‚æŸä¸€ä¸ªæ ·æœ¬å±äº1ï¼Œ2ä¸¤ä¸ªç±»åˆ«ï¼Œå¦‚æœæˆ‘ä»¬çš„ç½‘ç»œç®—å¾—è¯¥æ ·æœ¬åœ¨ç±»åˆ«1ï¼Œ2ä¸Šçš„
softmaxå€¼åˆ†åˆ«ä¸º0.7å’Œ0.9ï¼Œè€Œä¸”è¿™ä¸¤ä¸ªå€¼ä¹Ÿæ˜¯æœ€å¤§çš„ä¸¤ä¸ªå€¼ï¼Œè™½ç„¶æœ€ç»ˆç»“æœèƒ½å¾—å‡ºè¯¥æ ·æœ¬å±äº1ï¼Œ2ä¸¤ä¸ªç±»åˆ«ï¼Œä½†æ˜¯å…¶å®
ç½‘ç»œåœ¨åå‘æ±‚å¯¼çš„è¿‡ç¨‹ä¸­è¿˜æ˜¯ä¼šæƒ©ç½šè¿™ä¸¤ä¸ªè¾“å‡ºï¼Œå› ä¸ºä»–ä»¬ä¸æ˜¯1ï¼Œè€Œå¦‚æœä½¿ç”¨ sparsemax å°±ä¸ä¼šè¿™æ ·ï¼Œç»“æœä¹Ÿæ˜¯èƒ½å¤Ÿå¾—å‡ºè¯¥æ ·æœ¬
å±äº1ï¼Œ2ä¸¤ä¸ªç±»åˆ«ï¼Œè€Œä¸”åå‘çš„æ—¶å€™ä¸ä¼šå¯¹å®ƒä»¬è¿›è¡Œæƒ©ç½šã€‚æ‰€ä»¥ sparsemax åœ¨æŸäº›åº”ç”¨ä¸­ä¼¼ä¹ä¼šæ›´åŠ åˆç†ä¸€äº›ã€‚


[INVASE](https://openreview.net/pdf?id=BJg_roAcK7) è®ºæ–‡ä¸­ç”¨å®éªŒè¯´æ˜äº†ä½¿ç”¨å¸¦é€‰æ‹©æ€§çš„featureæ¯”ä½¿ç”¨å…¨éƒ¨çš„featureæ•ˆæœè¦å¥½ã€‚

[å¼ºåŒ–å­¦ä¹ RL](https://openreview.net/pdf?id=B1gJOoRcYQ)


