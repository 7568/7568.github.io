---
layout: blog
images-process: true
mathjax: true
title: "Shift-Net"
background-image: https://7568.github.io/images/2021-11-11-Shift-Net/img.png
date:  2021-11-11
category: 图像处理
tags:
- 神经网络
---
[Shift-Net-result]:https://7568.github.io/images/2021-11-11-Shift-Net/img.png
[shift-net-architecture]:https://7568.github.io/images/2021-11-11-Shift-Net/shift-net-architecture.png

# 前言描述

最近看到个挺有意思的论文，是利用神经网络进行空白填充，由于我最近正好也在做图像去雨滴的研究，训练的模型整体上还看得过去，但是在雨滴部分总是模糊的，
所以我就想再弄个图像去模糊的网络加在后面，让模糊的地方变得清晰。本来是想用桑农老师的图像去模糊的研究成果的，之前听过一次他的报告，去模糊的效果很好，
不过现在看到了这篇论文，就先看看这个，也正好再研究一下GAN。

该论文的名字叫 Shift-Net: Image Inpainting via Deep Feature Rearrangement 可从[✨⭐✨这里✨⭐✨](https://openaccess.thecvf.com/content_ECCV_2018/papers/Zhaoyi_Yan_Shift-Net_Image_Inpainting_ECCV_2018_paper.pdf) 下载，
代码的地址在 [✨⭐✨这里✨⭐✨](https://github.com/Zhaoyi-Yan/Shift-Net_pytorch) ，模型的效果如下图所示，看上去还是很好的。

![Shift-Net-result]

# 模型介绍

首先该模型解决的问题是给一张图像，然后遮住一部分，让模型来预测遮住的部分，学术上叫 image inpainting 。在图像处理上还有一个方向是 Style transfer，
改变图像的风格，在处理上与 image inpainting 有重合的地方，于是作者就将他们结合起来使用。

Shift-Net 也是 U-Net 结构的网络，不过他加了 shift connection 层。整体网络结构如下图：

![shift-net-architecture]

其中最特别的地方就是 shift connection 

我们先定义输入为 $$I$$ , $$I_{gt}$$ 为 ground-truth image ，  文章中最主要的两个关键点 guidance loss 和 shift operation。

# guidance loss
 设 $$\Omega$$ 为缺失的部分， $$\bar{\Omega}$$ 为已知部位，$$\Phi_l(I)$$ 表示第 l 层编码的特征，$$\Phi_{L-1}(I)$$ 表示第 l - 1 层的解码特征。
 $$L^{gt}$$ 为最终的结果。我们期望 $$\Phi_l(I)$$ 和 $$\Phi_{L-1}(I)$$ 能传达 $$\Phi_l(I^{gt})$$ 中的所以信息。对于任何 $$y \in \Omega$$ 
 我们都有 $$(\Phi_l(I))_y \approx 0$$ 。所以 $$(\Phi_{l-1}(I))_y$$ 就应该传达 $$(\Phi_l(I^{gt}))_y$$ 中的所以信息。
 
于是文章中就有了第一个 'guidance loss' ：

$$ $$
